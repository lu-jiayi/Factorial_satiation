filter(type == "test")
block_means = data_island %>%
group_by(block_number, length, stru_type) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
cbPalette = c("#e69d00", "#009e74","#d55e00",  "#cc79a7", "#0071b2")
#raw rating plot
island_raw_plot <- ggplot(data_island, aes(x = block_number, y=response, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_raw_plot
#z-score plot
island_zscore_plot <- ggplot(data_island, aes(x = block_number, y=z_score, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_zscore_plot
#DD score plot
data_island_dd <- data_island %>%
group_by(block_number, workerid) %>%
mutate(
long_nonisl = mean(z_score[stru_type == "nonisl" & length == "long"]),
long_isl = mean(z_score[stru_type == "isl" & length == "long"]),
short_nonisl = mean(z_score[stru_type == "nonisl" & length == "short"]),
short_isl = mean(z_score[stru_type == "isl" & length == "short"]),
DD = (long_nonisl - long_isl) - (short_nonisl - short_isl)
) %>%
ungroup() %>%
select(-long_nonisl, -long_isl, -short_nonisl, -short_isl) # remove intermediate columns
block_means_dd = data_island_dd %>%
group_by(block_number) %>%
summarize(DD = mean(DD)) %>%
ungroup()
DD_plot <- ggplot(data_island_dd, aes(x = block_number, y=DD)) +
geom_point(data=block_means_dd,alpha=.9) +
xlab("Block number") +
ylab("Average DD score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
DD_plot
###Looking at the filler conditions.
data_filler <- data_no_practice %>%
filter(type == "filler") %>%
mutate(filler_cond = str_sub(unique_id, 2, 3))
block_means_filler = data_filler %>%
group_by(block_number, filler_cond) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
#filler raw rating plot
filler_raw_plot <- ggplot(data_filler, aes(x = block_number, y=response)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
filler_raw_plot
#filler z-score plot
filler_zscore_plot <- ggplot(data_filler, aes(x = block_number, y=z_score)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
filler_zscore_plot
#########Stats############
#centering and scaling all predictors
data_island$block_number <- scale(data_island$block_number, center = TRUE, scale = FALSE)
data_island$length <- as.factor(data_island$length)
data_island$stru_type <- as.factor(data_island$stru_type)
data_island$length <- relevel(data_island$length, ref = "short")
data_island$stru_type <- relevel(data_island$stru_type, ref = "nonisl")
contrasts(data_island$length) <- contr.sum(2)
contrasts(data_island$stru_type) <- contr.sum(2)
#z-score 2*2*4 model for island items
lmer_island_zscore <- lmer(z_score~block_number*stru_type*length+
(1|workerid)+
(1 | item_number),
data = data_island)
summary(lmer_island_zscore)
`%notin%` <- Negate(`%in%`)
raw_data_path <- "adjunct_because_full.csv"
data<-read.csv(raw_data_path)
########Data pre-processing##########
#Remove practice items and attention checks
participants_to_exclude = c(1875, 1911, 1558, 1790, 1571, 1804, 1812, 1897)
data_no_practice <- data %>%
filter(block_number %in% c(1,2,3,4))%>%
filter(workerid %notin% participants_to_exclude)
#By-participant z-scoring raw responses
data_no_practice <- data_no_practice %>%
group_by(workerid) %>%  # Group by participant ID
mutate(z_score = (response - mean(response)) / sd(response)) %>%  # Calculate z-score
ungroup()
#inattentive participant removal: find filler items more than 3 standard deviations away from the item mean
filler <- data_no_practice %>%
filter(type == "filler") %>%
mutate(filler_cond = str_sub(unique_id, 2, 3))
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 6)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 2)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 3)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 4)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 5)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 6)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 7)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 4)
# Extract the list of workerids with more than 4 outlier exclusions
inattentive_list <- removed_df$workerid
# remove data by participants on the inattentive list
data_no_practice <- data_no_practice %>%
filter(workerid %notin% inattentive_list)
#################Plots####################
###Looking at the 4 critical conditions first.
data_island <- data_no_practice %>%
filter(type == "test")
block_means = data_island %>%
group_by(block_number, length, stru_type) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
cbPalette = c("#e69d00", "#009e74","#d55e00",  "#cc79a7", "#0071b2")
#raw rating plot
island_raw_plot <- ggplot(data_island, aes(x = block_number, y=response, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_raw_plot
#z-score plot
island_zscore_plot <- ggplot(data_island, aes(x = block_number, y=z_score, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_zscore_plot
#DD score plot
data_island_dd <- data_island %>%
group_by(block_number, workerid) %>%
mutate(
long_nonisl = mean(z_score[stru_type == "nonisl" & length == "long"]),
long_isl = mean(z_score[stru_type == "isl" & length == "long"]),
short_nonisl = mean(z_score[stru_type == "nonisl" & length == "short"]),
short_isl = mean(z_score[stru_type == "isl" & length == "short"]),
DD = (long_nonisl - long_isl) - (short_nonisl - short_isl)
) %>%
ungroup() %>%
select(-long_nonisl, -long_isl, -short_nonisl, -short_isl) # remove intermediate columns
block_means_dd = data_island_dd %>%
group_by(block_number) %>%
summarize(DD = mean(DD)) %>%
ungroup()
DD_plot <- ggplot(data_island_dd, aes(x = block_number, y=DD)) +
geom_point(data=block_means_dd,alpha=.9) +
xlab("Block number") +
ylab("Average DD score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
DD_plot
###Looking at the filler conditions.
data_filler <- data_no_practice %>%
filter(type == "filler") %>%
mutate(filler_cond = str_sub(unique_id, 2, 3))
block_means_filler = data_filler %>%
group_by(block_number, filler_cond) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
#filler raw rating plot
filler_raw_plot <- ggplot(data_filler, aes(x = block_number, y=response)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
filler_raw_plot
#filler z-score plot
filler_zscore_plot <- ggplot(data_filler, aes(x = block_number, y=z_score)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
filler_zscore_plot
#########Stats############
#centering and scaling all predictors
data_island$block_number <- scale(data_island$block_number, center = TRUE, scale = FALSE)
data_island$length <- as.factor(data_island$length)
data_island$stru_type <- as.factor(data_island$stru_type)
data_island$length <- relevel(data_island$length, ref = "short")
data_island$stru_type <- relevel(data_island$stru_type, ref = "nonisl")
contrasts(data_island$length) <- contr.sum(2)
contrasts(data_island$stru_type) <- contr.sum(2)
#z-score 2*2*4 model for island items
lmer_island_zscore <- lmer(z_score~block_number*stru_type*length+
(1|workerid)+
(1 | item_number),
data = data_island)
#z-score 2*2*4 model for island items
lmer_island_zscore <- lmer(z_score~block_number*stru_type*length+
(1+z_score~block_number*stru_type*length|workerid)+
(1+z_score~block_number*stru_type*length| item_number),
data = data_island)
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 4)
# Extract the list of workerids with more than 4 outlier exclusions
inattentive_list <- removed_df$workerid
# remove data by participants on the inattentive list
data_no_practice <- data_no_practice %>%
filter(workerid %notin% inattentive_list)
#################Plots####################
###Looking at the 4 critical conditions first.
data_island <- data_no_practice %>%
filter(type == "test")
block_means = data_island %>%
group_by(block_number, length, stru_type) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
cbPalette = c("#e69d00", "#009e74","#d55e00",  "#cc79a7", "#0071b2")
#raw rating plot
island_raw_plot <- ggplot(data_island, aes(x = block_number, y=response, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_raw_plot
#z-score plot
island_zscore_plot <- ggplot(data_island, aes(x = block_number, y=z_score, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_zscore_plot
#DD score plot
data_island_dd <- data_island %>%
group_by(block_number, workerid) %>%
mutate(
long_nonisl = mean(z_score[stru_type == "nonisl" & length == "long"]),
long_isl = mean(z_score[stru_type == "isl" & length == "long"]),
short_nonisl = mean(z_score[stru_type == "nonisl" & length == "short"]),
short_isl = mean(z_score[stru_type == "isl" & length == "short"]),
DD = (long_nonisl - long_isl) - (short_nonisl - short_isl)
) %>%
ungroup() %>%
select(-long_nonisl, -long_isl, -short_nonisl, -short_isl) # remove intermediate columns
block_means_dd = data_island_dd %>%
group_by(block_number) %>%
summarize(DD = mean(DD)) %>%
ungroup()
DD_plot <- ggplot(data_island_dd, aes(x = block_number, y=DD)) +
geom_point(data=block_means_dd,alpha=.9) +
xlab("Block number") +
ylab("Average DD score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
DD_plot
###Looking at the filler conditions.
data_filler <- data_no_practice %>%
filter(type == "filler") %>%
mutate(filler_cond = str_sub(unique_id, 2, 3))
block_means_filler = data_filler %>%
group_by(block_number, filler_cond) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
#filler raw rating plot
filler_raw_plot <- ggplot(data_filler, aes(x = block_number, y=response)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
filler_raw_plot
#filler z-score plot
filler_zscore_plot <- ggplot(data_filler, aes(x = block_number, y=z_score)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
filler_zscore_plot
#########Stats############
#centering and scaling all predictors
data_island$block_number <- scale(data_island$block_number, center = TRUE, scale = FALSE)
data_island$length <- as.factor(data_island$length)
data_island$stru_type <- as.factor(data_island$stru_type)
data_island$length <- relevel(data_island$length, ref = "short")
data_island$stru_type <- relevel(data_island$stru_type, ref = "nonisl")
contrasts(data_island$length) <- contr.sum(2)
contrasts(data_island$stru_type) <- contr.sum(2)
#z-score 2*2*4 model for island items
lmer_island_zscore <- lmer(z_score~block_number*stru_type*length+
(1|workerid)+
(1 | item_number),
data = data_island)
summary(lmer_island_zscore)
#z-score 2*2*4 model for island items
lmer_island_zscore <- lmer(z_score~block_number*stru_type*length+
(1+block_number*stru_type*length|workerid)+
(1+block_number*stru_type*length| item_number),
data = data_island)
this.dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this.dir)
library(plyr)
library(dplyr)
library(reshape)
library(ggplot2)
library(gtable)
library(lme4)
library(tidyverse)
library(lmerTest)
library(bootstrap)
library(ggpubr)
library(stringr)
library(brms)
library(BayesFactor)
`%notin%` <- Negate(`%in%`)
raw_data_path <- "adjunct_because_full.csv"
data<-read.csv(raw_data_path)
########Data pre-processing##########
#Remove practice items and attention checks
participants_to_exclude = c(1875, 1911, 1558, 1790, 1571, 1804, 1812, 1897)
data_no_practice <- data %>%
filter(block_number %in% c(1,2,3,4))%>%
filter(workerid %notin% participants_to_exclude)
#By-participant z-scoring raw responses
data_no_practice <- data_no_practice %>%
group_by(workerid) %>%  # Group by participant ID
mutate(z_score = (response - mean(response)) / sd(response)) %>%  # Calculate z-score
ungroup()
#inattentive participant removal: find filler items more than 3 standard deviations away from the item mean
filler <- data_no_practice %>%
filter(type == "filler") %>%
mutate(filler_cond = str_sub(unique_id, 2, 3))
removed_df <- filler %>%
group_by(unique_id) %>%
mutate(filler_z = (z_score - mean(z_score)) / sd(z_score)) %>%  # Calculate z-score
ungroup()  %>%
filter(filler_z < -2 | filler_z > 2) %>%
group_by(workerid) %>%
summarize(removed_count = n()) %>%
filter(removed_count > 4)
# Extract the list of workerids with more than 4 outlier exclusions
inattentive_list <- removed_df$workerid
# remove data by participants on the inattentive list
data_no_practice <- data_no_practice %>%
filter(workerid %notin% inattentive_list)
#################Plots####################
###Looking at the 4 critical conditions first.
data_island <- data_no_practice %>%
filter(type == "test")
block_means = data_island %>%
group_by(block_number, length, stru_type) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
cbPalette = c("#e69d00", "#009e74","#d55e00",  "#cc79a7", "#0071b2")
#raw rating plot
island_raw_plot <- ggplot(data_island, aes(x = block_number, y=response, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_raw_plot
#z-score plot
island_zscore_plot <- ggplot(data_island, aes(x = block_number, y=z_score, linetype = stru_type, fill=length)) +
geom_point(data=block_means,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
island_zscore_plot
#DD score plot
data_island_dd <- data_island %>%
group_by(block_number, workerid) %>%
mutate(
long_nonisl = mean(z_score[stru_type == "nonisl" & length == "long"]),
long_isl = mean(z_score[stru_type == "isl" & length == "long"]),
short_nonisl = mean(z_score[stru_type == "nonisl" & length == "short"]),
short_isl = mean(z_score[stru_type == "isl" & length == "short"]),
DD = (long_nonisl - long_isl) - (short_nonisl - short_isl)
) %>%
ungroup() %>%
select(-long_nonisl, -long_isl, -short_nonisl, -short_isl) # remove intermediate columns
block_means_dd = data_island_dd %>%
group_by(block_number) %>%
summarize(DD = mean(DD)) %>%
ungroup()
DD_plot <- ggplot(data_island_dd, aes(x = block_number, y=DD)) +
geom_point(data=block_means_dd,alpha=.9) +
xlab("Block number") +
ylab("Average DD score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw()
DD_plot
###Looking at the filler conditions.
data_filler <- data_no_practice %>%
filter(type == "filler") %>%
mutate(filler_cond = str_sub(unique_id, 2, 3))
block_means_filler = data_filler %>%
group_by(block_number, filler_cond) %>%
summarize(response = mean(response), z_score = mean(z_score)) %>%
ungroup()
#filler raw rating plot
filler_raw_plot <- ggplot(data_filler, aes(x = block_number, y=response)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
filler_raw_plot
#filler z-score plot
filler_zscore_plot <- ggplot(data_filler, aes(x = block_number, y=z_score)) +
geom_point(data=block_means_filler,alpha=.9) +
xlab("block number") +
ylab("average acceptability z-score")+
geom_smooth(method=lm) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
facet_wrap(~filler_cond)
